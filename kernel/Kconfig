menu "KernelSU"

config KSU
    tristate "KernelSU function support"
    default y
    help
      Enable kernel-level root privileges on Android System.
      To compile as a module, choose M here: the
      module will be called kernelsu.

config KSU_DEBUG
    bool "KernelSU debug mode"
    depends on KSU
    default n
    help
      Enable KernelSU debug mode.

config KSU_MANUAL_SU
    bool "Use manual su"
    depends on KSU
    default y
    help
      Use manual su and authorize the corresponding command line and application via prctl

config KPM
    bool "Enable SukiSU KPM"
    depends on KSU && 64BIT
    default n
    help
      Enabling this option will activate the KPM feature of SukiSU.
      This option is suitable for scenarios where you need to force KPM to be enabled.
      but it may affect system stability.
    select KALLSYMS
    select KALLSYMS_ALL

menu "KernelSU - SUSFS"

config KSU_SUSFS
    bool "KernelSU addon - SUSFS"
    depends on KSU
    default y
    help
      Integrate SUSFS into the kernel and expose its control interface via prctl.

config KSU_SUSFS_SUS_PATH
    bool "Enable to hide suspicious path"
    depends on KSU_SUSFS
    default y
    help
      Hide user-defined paths (and sub-paths) from various VFS lookups.

config KSU_SUSFS_SUS_MOUNT
    bool "Enable to hide suspicious mounts"
    depends on KSU_SUSFS
    default y
    help
      Hide user-defined mount paths from /proc/*/mounts and reorder mount IDs for
      processes spawned from zygote.

config KSU_SUSFS_SUS_KSTAT
    bool "Enable to spoof suspicious kstat"
    depends on KSU_SUSFS
    default y
    help
      Spoof stat() information (ino/dev/nlink/size/blocks/time) for user-defined
      file/directory paths.

config KSU_SUSFS_TRY_UMOUNT
    bool "Enable SUSFS try_umount"
    depends on KSU_SUSFS
    default y
    help
      Allow userspace to register mount paths to be unmounted for NO-root apps.

config KSU_SUSFS_SPOOF_UNAME
    bool "Enable to spoof uname"
    depends on KSU_SUSFS
    default y
    help
      Spoof uname(2) release/version strings for all processes.

config KSU_SUSFS_ENABLE_LOG
    bool "Enable SUSFS kernel logging"
    depends on KSU_SUSFS
    default y
    help
      Enable SUSFS logging. Disable to completely silence SUSFS logs.

config KSU_SUSFS_SUS_SU
    bool "Enable SUS-SU in runtime temporarily (experimental)"
    depends on KSU_SUSFS && OVERLAY_FS
    default n
    help
      Experimental: enable/disable SUS-SU support. Not required for SUSFS core
      hiding/spoofing features.

config KSU_SUSFS_OPEN_REDIRECT
    bool "Enavle to spoof open redirect"
    depends on KSU_SUSFS
    default y
    help
        Redirect user-defined file paths to alternative locations.

config KSU_SUSFS_SPOOF_CMDLINE_OR_BOOTCONFIG
    bool "Enable to spoof /proc/cmdline or /proc/bootconfig"
    depends on KSU_SUSFS
    default y
    help
        Spoof kernel command line or bootconfig via userspace control.

config KSU_SUSFS_AUTO_ADD_SUS_BIND_MOUNT
    bool "Auto add suspicious bind mount"
    depends on KSU_SUSFS_SUS_MOUNT
    default y

config KSU_SUSFS_AUTO_ADD_SUS_KSU_DEFAULT_MOUNT
    bool "Auto add suspicious KSU default mount"
    depends on KSU_SUSFS_SUS_MOUNT
    default y

config KSU_SUSFS_AUTO_ADD_TRY_UMOUNT_FOR_BIND_MOUNT
    bool "Auto add try umount for bind mount"
    depends on KSU_SUSFS_TRY_UMOUNT
    default y

config KSU_SUSFS_HAS_MAGIC_MOUNT
    bool "Enable support for magic mount"
    depends on KSU_SUSFS
    default y

endmenu

endmenu
